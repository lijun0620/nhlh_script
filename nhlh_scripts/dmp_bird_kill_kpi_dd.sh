#!/bin/bash

######################################################################
#                                                                    
# 程    序: dmp_bird_kill_kpi_dd.sh                               
# 创建时间: 2018年04月12日                                            
# 创 建 者: ch                                                      
# 参数:                                                              
#    参数1: 日期[yyyymmdd]                                             
# 补充说明: 
# 功    能: 禽屠宰指标日报
# 修改说明:                                                          
######################################################################

OP_DAY=$1
OP_MONTH=${OP_DAY:0:6}
OP_YEAR=${OP_DAY:0:4}

# 判断时间输入参数
if [ $# -ne 1 ]
then
    echo "输入参数错误，调用示例: dmp_bird_kill_kpi_dd.sh 20180101"
    exit 1
fi

# 当前时间
CREATE_TIME=$(date -d " -0 day" +%Y%m%d%H%M)


###########################################################################################
## 将数据从大表转换至目标表
## 变量声明
TMP_DMP_BIRD_KILL_KPI_DD_0='TMP_DMP_BIRD_KILL_KPI_DD_0'

CREATE_TMP_DMP_BIRD_KILL_KPI_DD_0="
CREATE TABLE IF NOT EXISTS $TMP_DMP_BIRD_KILL_KPI_DD_0
(
 MONTH_ID                      STRING    --期间(月)
,DAY_ID                        STRING    --期间(日)
,LEVEL1_ORG_ID                 STRING    --组织1级(股份)
,LEVEL1_ORG_DESCR              STRING    --组织1级(股份)
,LEVEL2_ORG_ID                 STRING    --组织2级(片联)
,LEVEL2_ORG_DESCR              STRING    --组织2级(片联)
,LEVEL3_ORG_ID                 STRING    --组织3级(片区)
,LEVEL3_ORG_DESCR              STRING    --组织3级(片区)
,LEVEL4_ORG_ID                 STRING    --组织4级(小片)
,LEVEL4_ORG_DESCR              STRING    --组织4级(小片)
,LEVEL5_ORG_ID                 STRING    --组织5级(公司)
,LEVEL5_ORG_DESCR              STRING    --组织5级(公司)
,LEVEL6_ORG_ID                 STRING    --组织6级(OU)
,LEVEL6_ORG_DESCR              STRING    --组织6级(OU)
,LEVEL7_ORG_ID                 STRING    --组织7级(库存组织)
,LEVEL7_ORG_DESCR              STRING    --组织7级(库存组织)
,LEVEL1_BUSINESSTYPE_ID        STRING    --业态1级
,LEVEL1_BUSINESSTYPE_NAME      STRING    --业态1级
,LEVEL2_BUSINESSTYPE_ID        STRING    --业态2级
,LEVEL2_BUSINESSTYPE_NAME      STRING    --业态2级
,LEVEL3_BUSINESSTYPE_ID        STRING    --业态3级
,LEVEL3_BUSINESSTYPE_NAME      STRING    --业态3级
,LEVEL4_BUSINESSTYPE_ID        STRING    --业态4级
,LEVEL4_BUSINESSTYPE_NAME      STRING    --业态4级
,PRODUCTION_LINE_ID            STRING    --产线id
,PRODUCTION_LINE_DESCR         STRING    --产线
,KPI_TYPE_CODE              STRING   --指标类型编码
,KPI_TYPE_NAME              STRING   --指标类型名称
,KPI_CAL                    STRING   --指标是否需要计算
,CAL_RULE                   STRING   --指标运算符号
,KPI_CODE                   STRING   --指标编码
,KPI_NAME                   STRING   --指标名称
,SUB_KPI_CODE               STRING   --子指标编码
,SUB_KPI_NAME               STRING   --子指标名称
,KPI_VALUE1_NAME            STRING   --指标值1名称
,KPI_VALUE1                 STRING   --指标值1
,KPI_VALUE2_NAME            STRING   --指标值2名称
,KPI_VALUE2                 STRING   --指标值2
,CREATE_TIME                STRING
)
PARTITIONED BY (op_day string,op_sub string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\011'
STORED AS TEXTFILE
"

## 转换数据
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
INSERT_TMP_DMP_BIRD_KILL_KPI_DD_0_1="
INSERT OVERWRITE TABLE $TMP_DMP_BIRD_KILL_KPI_DD_0 PARTITION(op_day='$OP_DAY',op_sub = '1')
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'PROD_QTY' KPI_CODE,
       '产量' KPI_NAME,
       'PROD_QTY' SUB_KPI_CODE,
       '产量' SUB_KPI_NAME,
       '产量' KPI_VALUE1_NAME,
       PROD_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'KILLED_QTY' KPI_CODE,
       '宰杀只数' KPI_NAME,
       'KILLED_QTY' SUB_KPI_CODE,
       '宰杀只数' SUB_KPI_NAME,
       '宰杀只数' KPI_VALUE1_NAME,
       KILLED_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'RECYCLE_WEIGHT' KPI_CODE,
       '结算重量(kg)' KPI_NAME,
       'RECYCLE_WEIGHT' SUB_KPI_CODE,
       '结算重量(kg)' SUB_KPI_NAME,
       '结算重量(kg)' KPI_VALUE1_NAME,
       RECYCLE_WEIGHT KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_PURCHASE_PRICE' KPI_CODE,
       '均购价' KPI_NAME,
       'AVG_PURCHASE_PRICE' SUB_KPI_CODE,
       '均购价' SUB_KPI_NAME,
       '结算金额+运费' KPI_VALUE1_NAME,
       RECYCLE_AMT + CARRIAGE_COST KPI_VALUE1,
       '结算重量' KPI_VALUE2_NAME,
       RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_WEIGHT' KPI_CODE,
       '平均只重' KPI_NAME,
       'AVG_WEIGHT' SUB_KPI_CODE,
       '平均只重' SUB_KPI_NAME,
       '结算重量' KPI_VALUE1_NAME,
       RECYCLE_WEIGHT KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'HC' KPI_CODE,
       '在职人数' KPI_NAME,
       'HC' SUB_KPI_CODE,
       '在职人数' SUB_KPI_NAME,
       '在职人数' KPI_VALUE1_NAME,
       HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'ACT_HC' KPI_CODE,
       '实际出勤' KPI_NAME,
       'ACT_HC' SUB_KPI_CODE,
       '实际出勤' SUB_KPI_NAME,
       '实际出勤' KPI_VALUE1_NAME,
       ACT_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'FRONT_HC' KPI_CODE,
       '前区在职' KPI_NAME,
       'FRONT_HC' SUB_KPI_CODE,
       '前区在职' SUB_KPI_NAME,
       '前区在职' KPI_VALUE1_NAME,
       FRONT_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'ACT_FRONT_HC' KPI_CODE,
       '前区实际出勤' KPI_NAME,
       'ACT_FRONT_HC' SUB_KPI_CODE,
       '前区实际出勤' SUB_KPI_NAME,
       '前区实际出勤' KPI_VALUE1_NAME,
       ACT_FRONT_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'BACK_HC' KPI_CODE,
       '后区在职' KPI_NAME,
       'BACK_HC' SUB_KPI_CODE,
       '后区在职' SUB_KPI_NAME,
       '后区在职' KPI_VALUE1_NAME,
       BACK_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'ACT_BACK_HC' KPI_CODE,
       '后区实际出勤' KPI_NAME,
       'ACT_BACK_HC' SUB_KPI_CODE,
       '后区实际出勤' SUB_KPI_NAME,
       '后区实际出勤' KPI_VALUE1_NAME,
       ACT_BACK_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'KT_HC' KPI_CODE,
       '库台在职' KPI_NAME,
       'KT_HC' SUB_KPI_CODE,
       '库台在职' SUB_KPI_NAME,
       '库台在职' KPI_VALUE1_NAME,
       KT_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'ACT_KT_HC' KPI_CODE,
       '库台实际出勤' KPI_NAME,
       'ACT_KT_HC' SUB_KPI_CODE,
       '库台实际出勤' SUB_KPI_NAME,
       '库台实际出勤' KPI_VALUE1_NAME,
       ACT_KT_HC KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'WORKING_TIME' KPI_CODE,
       '工作时间' KPI_NAME,
       'WORKING_TIME' SUB_KPI_CODE,
       '工作时间' SUB_KPI_NAME,
       '工作时间' KPI_VALUE1_NAME,
       WORKING_TIME KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_PROD_QTY' KPI_CODE,
       '生产人均时产量（kg/h)' KPI_NAME,
       'AVG_PROD_QTY' SUB_KPI_CODE,
       '生产人均时产量（kg/h)' SUB_KPI_NAME,
       '产量' KPI_VALUE1_NAME,
       PROD_QTY KPI_VALUE1,
       '工作时间' KPI_VALUE2_NAME,
       WORKING_TIME KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_KILLED_QTY_P' KPI_CODE,
       '生产人均日屠宰量（只/日/人)' KPI_NAME,
       'AVG_KILLED_QTY_P' SUB_KPI_CODE,
       '生产人均日屠宰量（只/日/人)' SUB_KPI_NAME,
       '宰杀只数' KPI_VALUE1_NAME,
       KILLED_QTY KPI_VALUE1,
       '实际出勤' KPI_VALUE2_NAME,
       ACT_HC KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEF_PROD_RATE' KPI_CODE,
       '总次品率' KPI_NAME,
       'DEF_PROD_RATE' SUB_KPI_CODE,
       '总次品率' SUB_KPI_NAME,
       '次品量' KPI_VALUE1_NAME,
       DEF_PROD_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEF_HEAD_RATE' KPI_CODE,
       '次头率' KPI_NAME,
       'DEF_HEAD_RATE' SUB_KPI_CODE,
       '次头率' SUB_KPI_NAME,
       '次头量' KPI_VALUE1_NAME,
       DEF_HEAD_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEF_NECK_RATE' KPI_CODE,
       '次脖率' KPI_NAME,
       'DEF_NECK_RATE' SUB_KPI_CODE,
       '次脖率' SUB_KPI_NAME,
       '次脖量' KPI_VALUE1_NAME,
       DEF_NECK_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEF_WING_RATE' KPI_CODE,
       '次二节翅率' KPI_NAME,
       'DEF_WING_RATE' SUB_KPI_CODE,
       '次二节翅率' SUB_KPI_NAME,
       '次二节翅量' KPI_VALUE1_NAME,
       DEF_WING_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEF_ROOT_WING_RATE' KPI_CODE,
       '次翅根率' KPI_NAME,
       'DEF_ROOT_WING_RATE' SUB_KPI_CODE,
       '次翅根率' SUB_KPI_NAME,
       '次翅根量' KPI_VALUE1_NAME,
       DEF_ROOT_WING_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEF_FEET_RATE' KPI_CODE,
       '次掌率' KPI_NAME,
       'DEF_FEET_RATE' SUB_KPI_CODE,
       '次掌率' SUB_KPI_NAME,
       '次掌量' KPI_VALUE1_NAME,
       DEF_FEET_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'COMP_RATE' KPI_CODE,
       '综合出成' KPI_NAME,
       'COMP_RATE' SUB_KPI_CODE,
       '综合出成' SUB_KPI_NAME,
       '产量' KPI_VALUE1_NAME,
       PROD_QTY KPI_VALUE1,
       '结算重量' KPI_VALUE2_NAME,
       RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MAINPROD_RATE' KPI_CODE,
       '主产出成' KPI_NAME,
       'MAINPROD_RATE' SUB_KPI_CODE,
       '主产出成' SUB_KPI_NAME,
       '主产产量' KPI_VALUE1_NAME,
       MAINPROD_QTY KPI_VALUE1,
       '结算重量' KPI_VALUE2_NAME,
       RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'BYPROD_RATE' KPI_CODE,
       '副产出成' KPI_NAME,
       'BYPROD_RATE' SUB_KPI_CODE,
       '副产出成' SUB_KPI_NAME,
       '副产产量' KPI_VALUE1_NAME,
       BYPROD_QTY KPI_VALUE1,
       '结算重量' KPI_VALUE2_NAME,
       RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'BODY_RATE' KPI_CODE,
       '胴体出成' KPI_NAME,
       'BODY_RATE' SUB_KPI_CODE,
       '胴体出成' SUB_KPI_NAME,
       '胴体结算重量' KPI_VALUE1_NAME,
       BODY_WEIGHT KPI_VALUE1,
       '结算重量' KPI_VALUE2_NAME,
       RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROD_RATE' KPI_CODE,
       '加工出成' KPI_NAME,
       'PROD_RATE' SUB_KPI_CODE,
       '加工出成' SUB_KPI_NAME,
       '产量' KPI_VALUE1_NAME,
       PROD_QTY KPI_VALUE1,
       '胴体结算重量' KPI_VALUE2_NAME,
       BODY_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'EMP_LOSS' KPI_CODE,
       '员工流失率' KPI_NAME,
       'EMP_LOSS' SUB_KPI_CODE,
       '员工流失率' SUB_KPI_NAME,
       '月初人数-当日人数' KPI_VALUE1_NAME,
       MONTH_BEG_HC - HC KPI_VALUE1,
       '(月初人数+当日人数)/2' KPI_VALUE2_NAME,
       (MONTH_BEG_HC + HC) / 2 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'PRECOOLING_TEMPERATURE' KPI_CODE,
       '预冷温度（后池）' KPI_NAME,
       'PRECOOLING_TEMPERATURE' SUB_KPI_CODE,
       '预冷温度（后池）' SUB_KPI_NAME,
       '预冷温度（后池）' KPI_VALUE1_NAME,
       PRECOOLING_TEMPERATURE KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'PRECOOLING_TIME' KPI_CODE,
       '预冷时间' KPI_NAME,
       'PRECOOLING_TIME' SUB_KPI_CODE,
       '预冷时间' SUB_KPI_NAME,
       '预冷时间' KPI_VALUE1_NAME,
       PRECOOLING_TIME KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'EMPTY_HOOKS_RATE' KPI_CODE,
       '空钩率' KPI_NAME,
       'EMPTY_HOOKS_RATE' SUB_KPI_CODE,
       '空钩率' SUB_KPI_NAME,
       '空钩个数' KPI_VALUE1_NAME,
       EMPTY_HOOKS_NUMBER KPI_VALUE1,
       '钩数（基数）' KPI_VALUE2_NAME,
       HOOKS_NUMBER KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'CONTRACT_QTY' KPI_CODE,
       '合同数量' KPI_NAME,
       'CONTRACT_QTY' SUB_KPI_CODE,
       '合同数量' SUB_KPI_NAME,
       '合同数量' KPI_VALUE1_NAME,
       CONTRACT_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'VALUE_CONTRACT_QTY' KPI_CODE,
       '保值合同数量' KPI_NAME,
       'VALUE_CONTRACT_QTY' SUB_KPI_CODE,
       '保值合同数量' SUB_KPI_NAME,
       '保值合同数量' KPI_VALUE1_NAME,
       VALUE_CONTRACT_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'MINI_CONTRACT_QTY' KPI_CODE,
       '保底合同数量' KPI_NAME,
       'MINI_CONTRACT_QTY' SUB_KPI_CODE,
       '保底合同数量' SUB_KPI_NAME,
       '保底合同数量' KPI_VALUE1_NAME,
       MINI_CONTRACT_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'CONTRACT_PRICE' KPI_CODE,
       '合同价格' KPI_NAME,
       'CONTRACT_PRICE' SUB_KPI_CODE,
       '合同价格' SUB_KPI_NAME,
       '合同金额+运费' KPI_VALUE1_NAME,
       CONTRACT_RECYCLE_AMT + CONTRACT_CARRIAGE_COST KPI_VALUE1,
       '合同结算重量' KPI_VALUE2_NAME,
       CONTRACT_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'VALUE_CONTRACT_PRICE' KPI_CODE,
       '保值合同价格' KPI_NAME,
       'VALUE_CONTRACT_PRICE' SUB_KPI_CODE,
       '保值合同价格' SUB_KPI_NAME,
       '保值合同金额+运费' KPI_VALUE1_NAME,
       VALUE_CONTRACT_RECYCLE_AMT + VALUE_CARRIAGE_COST KPI_VALUE1,
       '保值合同数量' KPI_VALUE2_NAME,
       VALUE_CONTRACT_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MINI_CONTRACT_PRICE' KPI_CODE,
       '保底合同价格' KPI_NAME,
       'MINI_CONTRACT_PRICE' SUB_KPI_CODE,
       '保底合同价格' SUB_KPI_NAME,
       '保底合同金额+运费' KPI_VALUE1_NAME,
       MINI_CONTRACT_RECYCLE_AMT + MINI_CARRIAGE_COST KPI_VALUE1,
       '保底合同数量' KPI_VALUE2_NAME,
       MINI_CONTRACT_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'MARKET_QTY' KPI_CODE,
       '市场数量' KPI_NAME,
       'MARKET_QTY' SUB_KPI_CODE,
       '市场数量' SUB_KPI_NAME,
       '市场数量' KPI_VALUE1_NAME,
       MARKET_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MARKET_PRICE' KPI_CODE,
       '市场价格' KPI_NAME,
       'MARKET_PRICE' SUB_KPI_CODE,
       '市场价格' SUB_KPI_NAME,
       '市场金额+运费' KPI_VALUE1_NAME,
       MARKET_RECYCLE_AMT + MARKET_CARRIAGE_COST KPI_VALUE1,
       '市场数量' KPI_VALUE2_NAME,
       MARKET_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'WORKING_DAY' KPI_CODE,
       '生产天数' KPI_NAME,
       'WORKING_DAY' SUB_KPI_CODE,
       '生产天数' SUB_KPI_NAME,
       '生产天数' KPI_VALUE1_NAME,
       WORKING_DAY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'KILLING_DAY' KPI_CODE,
       '均衡回收天数' KPI_NAME,
       'KILLING_DAY' SUB_KPI_CODE,
       '均衡回收天数' SUB_KPI_NAME,
       '均衡宰杀天数' KPI_VALUE1_NAME,
       KILLING_DAY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'KILLING_RATE' KPI_CODE,
       '回收均衡度(%)' KPI_NAME,
       'KILLING_RATE' SUB_KPI_CODE,
       '回收均衡度(%)' SUB_KPI_NAME,
       '均衡宰杀天数' KPI_VALUE1_NAME,
       KILLING_DAY KPI_VALUE1,
       '生产天数' KPI_VALUE2_NAME,
       WORKING_DAY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_KILLED_QTY_T' KPI_CODE,
       '宰杀时效' KPI_NAME,
       'AVG_KILLED_QTY_T' SUB_KPI_CODE,
       '宰杀时效' SUB_KPI_NAME,
       '宰杀只数' KPI_VALUE1_NAME,
       KILLED_QTY KPI_VALUE1,
       '工作时间' KPI_VALUE2_NAME,
       WORKING_TIME KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'BEST_RANGE_RATE' KPI_CODE,
       '最佳只重比例' KPI_NAME,
       'BEST_RANGE_RATE' SUB_KPI_CODE,
       '最佳只重比例' SUB_KPI_NAME,
       '只重在最佳范围的只数' KPI_VALUE1_NAME,
       BEST_RANGE_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'EQUIPMENT_STAGNATION_TIME' KPI_CODE,
       '设备停滞时间' KPI_NAME,
       'EQUIPMENT_STAGNATION_TIME' SUB_KPI_CODE,
       '设备停滞时间' SUB_KPI_NAME,
       '设备停滞时间' KPI_VALUE1_NAME,
       EQUIPMENT_STAGNATION_TIME KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'RAW_CHICKEN_DUCK_TIME' KPI_CODE,
       '原料空鸡/鸭时间' KPI_NAME,
       'RAW_CHICKEN_DUCK_TIME' SUB_KPI_CODE,
       '原料空鸡/鸭时间' SUB_KPI_NAME,
       '原料空鸡/鸭时间' KPI_VALUE1_NAME,
       RAW_CHICKEN_DUCK_TIME KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEATH_NUMBER' KPI_CODE,
       '途中死鸭只数' KPI_NAME,
       'DEATH_NUMBER' SUB_KPI_CODE,
       '途中死鸭只数' SUB_KPI_NAME,
       '途中死鸭只数' KPI_VALUE1_NAME,
       DEATH_NUMBER KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'DEATH_RATE' KPI_CODE,
       '途中死亡率' KPI_NAME,
       'DEATH_RATE' SUB_KPI_CODE,
       '途中死亡率' SUB_KPI_NAME,
       '途中死鸭只数' KPI_VALUE1_NAME,
       DEATH_NUMBER KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'UNDER_4_RATE' KPI_CODE,
       '4斤以下比例' KPI_NAME,
       'UNDER_4_RATE' SUB_KPI_CODE,
       '4斤以下比例' SUB_KPI_NAME,
       '4斤以下只数' KPI_VALUE1_NAME,
       UNDER_4_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '401_450_RATE' KPI_CODE,
       '4.01_4.50比例' KPI_NAME,
       '401_450_RATE' SUB_KPI_CODE,
       '4.01_4.50比例' SUB_KPI_NAME,
       '4.01_4.50斤只数' KPI_VALUE1_NAME,
       401_450_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '451_480_RATE' KPI_CODE,
       '4.51_4.80斤只数比例' KPI_NAME,
       '451_480_RATE' SUB_KPI_CODE,
       '4.51_4.80斤只数比例' SUB_KPI_NAME,
       '4.51_4.80斤只数' KPI_VALUE1_NAME,
       451_480_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '481_550_RATE' KPI_CODE,
       '4.81_5.50斤只数比例' KPI_NAME,
       '481_550_RATE' SUB_KPI_CODE,
       '4.81_5.50斤只数比例' SUB_KPI_NAME,
       '4.81_5.50斤只数' KPI_VALUE1_NAME,
       481_550_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'OVER_551_RATE' KPI_CODE,
       '5.5斤以上只数比例' KPI_NAME,
       'OVER_551_RATE' SUB_KPI_CODE,
       '5.5斤以上只数比例' SUB_KPI_NAME,
       '5.50斤以上只数' KPI_VALUE1_NAME,
       OVER_551_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'UNDER_5_RATE' KPI_CODE,
       '5斤以下比例' KPI_NAME,
       'UNDER_5_RATE' SUB_KPI_CODE,
       '5斤以下比例' SUB_KPI_NAME,
       '5斤以下只数' KPI_VALUE1_NAME,
       UNDER_5_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '501_550_RATE' KPI_CODE,
       '5.01_5.50斤比例' KPI_NAME,
       '501_550_RATE' SUB_KPI_CODE,
       '5.01_5.50斤比例' SUB_KPI_NAME,
       '5.01_5.50斤只数' KPI_VALUE1_NAME,
       501_550_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '551_570_RATE' KPI_CODE,
       '5.51_5.70斤只数比例' KPI_NAME,
       '551_570_RATE' SUB_KPI_CODE,
       '5.51_5.70斤只数比例' SUB_KPI_NAME,
       '5.51_5.70斤只数' KPI_VALUE1_NAME,
       551_570_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '571_6_RATE' KPI_CODE,
       '5.71_6斤比例' KPI_NAME,
       '571_6_RATE' SUB_KPI_CODE,
       '5.71_6斤比例' SUB_KPI_NAME,
       '5.71_6斤只数' KPI_VALUE1_NAME,
       571_6_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '601_630_RATE' KPI_CODE,
       '6.01_6.3斤比例' KPI_NAME,
       '601_630_RATE' SUB_KPI_CODE,
       '6.01_6.3斤比例' SUB_KPI_NAME,
       '6.01_6.3斤只数' KPI_VALUE1_NAME,
       601_630_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'OVER_631_RATE' KPI_CODE,
       '6.3斤以上只数比例' KPI_NAME,
       'OVER_631_RATE' SUB_KPI_CODE,
       '6.3斤以上只数比例' SUB_KPI_NAME,
       '6.3斤以上只数' KPI_VALUE1_NAME,
       OVER_631_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'RECYCLE_RATE' KPI_CODE,
       '回收率' KPI_NAME,
       'RECYCLE_RATE' SUB_KPI_CODE,
       '回收率' SUB_KPI_NAME,
       '合同宰杀只数' KPI_VALUE1_NAME,
       CONTRACT_QTY KPI_VALUE1,
       '投放数量' KPI_VALUE2_NAME,
       PUT_QTY2 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'PUT_QTY' KPI_CODE,
       '投放数量' KPI_NAME,
       'PUT_QTY' SUB_KPI_CODE,
       '投放数量' SUB_KPI_NAME,
       '投放数量' KPI_VALUE1_NAME,
       PUT_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
"

## 转换数据
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
INSERT_TMP_DMP_BIRD_KILL_KPI_DD_0_2="
INSERT OVERWRITE TABLE $TMP_DMP_BIRD_KILL_KPI_DD_0 PARTITION(op_day='$OP_DAY',op_sub = '2')
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PUT_COST' KPI_CODE,
       '投放成本' KPI_NAME,
       'PUT_COST' SUB_KPI_CODE,
       '投放成本' SUB_KPI_NAME,
       '投放成本*投放数量' KPI_VALUE1_NAME,
       PUT_AMT KPI_VALUE1,
       '投放数量' KPI_VALUE2_NAME,
       PUT_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'VALUE_PUT_QTY' KPI_CODE,
       '保值投放数量' KPI_NAME,
       'VALUE_PUT_QTY' SUB_KPI_CODE,
       '保值投放数量' SUB_KPI_NAME,
       '保值投放数量' KPI_VALUE1_NAME,
       VALUE_PUT_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'VALUE_PUT_COST' KPI_CODE,
       '保值投放成本' KPI_NAME,
       'VALUE_PUT_COST' SUB_KPI_CODE,
       '保值投放成本' SUB_KPI_NAME,
       '保值投放成本*保值投放数量' KPI_VALUE1_NAME,
       VALUE_PUT_AMT KPI_VALUE1,
       '保值投放数量' KPI_VALUE2_NAME,
       VALUE_PUT_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'VALUE_PUT_RATE' KPI_CODE,
       '保值比例' KPI_NAME,
       'VALUE_PUT_RATE' SUB_KPI_CODE,
       '保值比例' SUB_KPI_NAME,
       '保值投放数量' KPI_VALUE1_NAME,
       VALUE_PUT_QTY KPI_VALUE1,
       '投放数量' KPI_VALUE2_NAME,
       PUT_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'UNDER_50_RATE' KPI_CODE,
       '50km以内比例' KPI_NAME,
       'UNDER_50_RATE' SUB_KPI_CODE,
       '50km以内比例' SUB_KPI_NAME,
       '50km以内数量' KPI_VALUE1_NAME,
       UNDER_50_KILLED_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       '50_80_RATE' KPI_CODE,
       '50-80km比例' KPI_NAME,
       '50_80_RATE' SUB_KPI_CODE,
       '50-80km比例' SUB_KPI_NAME,
       '50-80km数量' KPI_VALUE1_NAME,
       50_80_KILLED_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'OVER_50_RATE' KPI_CODE,
       '80km以上比例' KPI_NAME,
       'OVER_50_RATE' SUB_KPI_CODE,
       '80km以上比例' SUB_KPI_NAME,
       '80km以上数量' KPI_VALUE1_NAME,
       OVER_80_KILLED_QTY KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'SECND_INPUT' KPI_CODE,
       '吨产品副产品收入' KPI_NAME,
       'SECND_INPUT' SUB_KPI_CODE,
       '吨产品副产品收入' SUB_KPI_NAME,
       '产品副产品收入' KPI_VALUE1_NAME,
       SECND_INPUT KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'UNDER_4_QTY' KPI_CODE,
       '4斤以下只数' KPI_NAME,
       'UNDER_4_QTY' SUB_KPI_CODE,
       '4斤以下只数' SUB_KPI_NAME,
       '4斤以下只数' KPI_VALUE1_NAME,
       UNDER_4_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '401_450_QTY' KPI_CODE,
       '4.01_4.50斤只数' KPI_NAME,
       '401_450_QTY' SUB_KPI_CODE,
       '4.01_4.50斤只数' SUB_KPI_NAME,
       '4.01_4.50斤只数' KPI_VALUE1_NAME,
       401_450_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '451_480_QTY' KPI_CODE,
       '4.51_4.80斤只数' KPI_NAME,
       '451_480_QTY' SUB_KPI_CODE,
       '4.51_4.80斤只数' SUB_KPI_NAME,
       '4.51_4.80斤只数' KPI_VALUE1_NAME,
       451_480_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '481_550_QTY' KPI_CODE,
       '4.81_5.50斤只数' KPI_NAME,
       '481_550_QTY' SUB_KPI_CODE,
       '4.81_5.50斤只数' SUB_KPI_NAME,
       '4.81_5.50斤只数' KPI_VALUE1_NAME,
       481_550_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'OVER_551_QTY' KPI_CODE,
       '5.50斤以上只数' KPI_NAME,
       'OVER_551_QTY' SUB_KPI_CODE,
       '5.50斤以上只数' SUB_KPI_NAME,
       '5.50斤以上只数' KPI_VALUE1_NAME,
       OVER_551_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'UNDER_5_QTY' KPI_CODE,
       '5斤以下只数' KPI_NAME,
       'UNDER_5_QTY' SUB_KPI_CODE,
       '5斤以下只数' SUB_KPI_NAME,
       '5斤以下只数' KPI_VALUE1_NAME,
       UNDER_5_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '501_550_QTY' KPI_CODE,
       '5.01_5.50斤只数' KPI_NAME,
       '501_550_QTY' SUB_KPI_CODE,
       '5.01_5.50斤只数' SUB_KPI_NAME,
       '5.01_5.50斤只数' KPI_VALUE1_NAME,
       501_550_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '551_570_QTY' KPI_CODE,
       '5.51_5.70斤只数' KPI_NAME,
       '551_570_QTY' SUB_KPI_CODE,
       '5.51_5.70斤只数' SUB_KPI_NAME,
       '5.51_5.70斤只数' KPI_VALUE1_NAME,
       551_570_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '571_6_QTY' KPI_CODE,
       '5.71_6斤只数' KPI_NAME,
       '571_6_QTY' SUB_KPI_CODE,
       '5.71_6斤只数' SUB_KPI_NAME,
       '5.71_6斤只数' KPI_VALUE1_NAME,
       571_6_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       '601_630_QTY' KPI_CODE,
       '6.01_6.3斤只数' KPI_NAME,
       '601_630_QTY' SUB_KPI_CODE,
       '6.01_6.3斤只数' SUB_KPI_NAME,
       '6.01_6.3斤只数' KPI_VALUE1_NAME,
       601_630_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'OVER_631_QTY' KPI_CODE,
       '6.3斤以上只数' KPI_NAME,
       'OVER_631_QTY' SUB_KPI_CODE,
       '6.3斤以上只数' SUB_KPI_NAME,
       '6.3斤以上只数' KPI_VALUE1_NAME,
       OVER_631_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'RECYCLE_WEIGHT' KPI_CODE,
       '结算重量' KPI_NAME,
       'RECYCLE_WEIGHT' SUB_KPI_CODE,
       '结算重量' SUB_KPI_NAME,
       '结算重量(kg)' KPI_VALUE1_NAME,
       RECYCLE_WEIGHT KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_PURCHASE_PRICE' KPI_CODE,
       '均购价' KPI_NAME,
       'AVG_PURCHASE_PRICE' SUB_KPI_CODE,
       '均购价' SUB_KPI_NAME,
       '结算金额+运费' KPI_VALUE1_NAME,
       RECYCLE_AMT + CARRIAGE_COST KPI_VALUE1,
       '结算重量' KPI_VALUE2_NAME,
       RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'AVG_WEIGHT' KPI_CODE,
       '平均只重' KPI_NAME,
       'AVG_WEIGHT' SUB_KPI_CODE,
       '平均只重' SUB_KPI_NAME,
       '结算重量(kg)' KPI_VALUE1_NAME,
       RECYCLE_WEIGHT KPI_VALUE1,
       '宰杀只数' KPI_VALUE2_NAME,
       KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'COMP_PRICE' KPI_CODE,
       '吨综合售价B' KPI_NAME,
       'COMP_PRICE' SUB_KPI_CODE,
       '吨综合售价B' SUB_KPI_NAME,
       '产量*当前售价/税率' KPI_VALUE1_NAME,
       SALES_AMT KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MAINPROD_PRICE' KPI_CODE,
       '吨主产售价' KPI_NAME,
       'MAINPROD_PRICE' SUB_KPI_CODE,
       '吨主产售价' SUB_KPI_NAME,
       '主产产量*当前售价/税率' KPI_VALUE1_NAME,
       MAINPROD_SALES_AMT KPI_VALUE1,
       '主产产量' KPI_VALUE2_NAME,
       MAINPROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'BYPROD_PRICE' KPI_CODE,
       '吨副产售价' KPI_NAME,
       'BYPROD_PRICE' SUB_KPI_CODE,
       '吨副产售价' SUB_KPI_NAME,
       '副产产量*当前售价/税率' KPI_VALUE1_NAME,
       BYPROD_SALES_AMT KPI_VALUE1,
       '副产产量' KPI_VALUE2_NAME,
       BYPROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'INPUT_TAX' KPI_CODE,
       '可抵扣进项税' KPI_NAME,
       'INPUT_TAX' SUB_KPI_CODE,
       '可抵扣进项税' SUB_KPI_NAME,
       '可抵扣进项税' KPI_VALUE1_NAME,
       INPUT_TAX KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEF_PROD_QTY' KPI_CODE,
       '次品量' KPI_NAME,
       'DEF_PROD_QTY' SUB_KPI_CODE,
       '次品量' SUB_KPI_NAME,
       '次品量' KPI_VALUE1_NAME,
       DEF_PROD_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEF_HEAD_QTY' KPI_CODE,
       '次头量' KPI_NAME,
       'DEF_HEAD_QTY' SUB_KPI_CODE,
       '次头量' SUB_KPI_NAME,
       '次头量' KPI_VALUE1_NAME,
       DEF_HEAD_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEF_NECK_QTY' KPI_CODE,
       '次脖量' KPI_NAME,
       'DEF_NECK_QTY' SUB_KPI_CODE,
       '次脖量' SUB_KPI_NAME,
       '次脖量' KPI_VALUE1_NAME,
       DEF_NECK_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEF_WING_QTY' KPI_CODE,
       '次二节翅量' KPI_NAME,
       'DEF_WING_QTY' SUB_KPI_CODE,
       '次二节翅量' SUB_KPI_NAME,
       '次二节翅量' KPI_VALUE1_NAME,
       DEF_WING_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEF_ROOT_WING_QTY' KPI_CODE,
       '次翅根量' KPI_NAME,
       'DEF_ROOT_WING_QTY' SUB_KPI_CODE,
       '次翅根量' SUB_KPI_NAME,
       '次翅根量' KPI_VALUE1_NAME,
       DEF_ROOT_WING_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '1' KPI_CAL,
       '1' CAL_RULE,
       'DEF_FEET_QTY' KPI_CODE,
       '次掌量' KPI_NAME,
       'DEF_FEET_QTY' SUB_KPI_CODE,
       '次掌量' SUB_KPI_NAME,
       '次掌量' KPI_VALUE1_NAME,
       DEF_FEET_QTY KPI_VALUE1,
       '' KPI_VALUE2_NAME,
       0 KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'NET_COST' KPI_CODE,
       '毛鸡毛鸭成本' KPI_NAME,
       'NET_COST1' SUB_KPI_CODE,
       '毛鸡毛鸭成本1' SUB_KPI_NAME,
       '结算金额+运费' KPI_VALUE1_NAME,
       CASE
         WHEN coalesce(INPUT_TAX, 0) = 0 THEN
          RECYCLE_AMT_BEFTAX + CARRIAGE_COST
         ELSE
          RECYCLE_AMT + CARRIAGE_COST
       END KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '2' KPI_TYPE_CODE,
       '原料指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '-1' CAL_RULE,
       'NET_COST' KPI_CODE,
       '毛鸡毛鸭成本' KPI_NAME,
       'NET_COST2' SUB_KPI_CODE,
       '毛鸡毛鸭成本2' SUB_KPI_NAME,
       '可抵进项税' KPI_VALUE1_NAME,
       INPUT_TAX KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'ADDITIONAL_PRICE' KPI_CODE,
       '附加值' KPI_NAME,
       'ADDITIONAL_PRICE1' SUB_KPI_CODE,
       '附加值1' SUB_KPI_NAME,
       '综合售价B-(结算金额+运费)' KPI_VALUE1_NAME,
       SALES_AMT - CARRIAGE_COST - CASE
         WHEN coalesce(INPUT_TAX, 0) = 0 THEN
          RECYCLE_AMT_BEFTAX
         ELSE
          RECYCLE_AMT
       END KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'ADDITIONAL_PRICE' KPI_CODE,
       '附加值' KPI_NAME,
       'ADDITIONAL_PRICE2' SUB_KPI_CODE,
       '附加值2' SUB_KPI_NAME,
       '副产品收入+可抵进项税' KPI_VALUE1_NAME,
       SECND_INPUT + INPUT_TAX KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'CONTRACT_ADDITIONAL_PRICE' KPI_CODE,
       '合同附加值' KPI_NAME,
       'CONTRACT_ADDITIONAL_PRICE1' SUB_KPI_CODE,
       '合同附加值1' SUB_KPI_NAME,
       '合同综合售价B-(合同结算金额+运费)' KPI_VALUE1_NAME,
       CASE WHEN NVL(CONTRACT_QTY,0) = 0 THEN 0 
       ELSE (  SALES_AMT * CONTRACT_WEIGHT
             - CONTRACT_CARRIAGE_COST * RECYCLE_WEIGHT 
             - (CASE WHEN NVL(INPUT_TAX ,0) = 0 
                THEN CONTRACT_RECYCLE_AMT_BEFTAX  
                ELSE CONTRACT_RECYCLE_AMT END) * RECYCLE_WEIGHT
            ) END KPI_VALUE1,
       '合同结算重量*综合出成' KPI_VALUE2_NAME,
       CONTRACT_WEIGHT*PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'CONTRACT_ADDITIONAL_PRICE' KPI_CODE,
       '合同附加值' KPI_NAME,
       'CONTRACT_ADDITIONAL_PRICE2' SUB_KPI_CODE,
       '合同附加值2' SUB_KPI_NAME,
       '副产品收入+可抵进项税' KPI_VALUE1_NAME,
       CASE WHEN NVL(CONTRACT_QTY,0) = 0 THEN 0 ELSE (SECND_INPUT + INPUT_TAX) END KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MARKET_ADDITIONA_PRICE' KPI_CODE,
       '市场附加值' KPI_NAME,
       'MARKET_ADDITIONA_PRICE1' SUB_KPI_CODE,
       '市场附加值1' SUB_KPI_NAME,
       '市场综合售价B-(市场结算金额+运费)' KPI_VALUE1_NAME,
       CASE WHEN NVL(MARKET_QTY,0) = 0 THEN 0 
       ELSE (  SALES_AMT * MARKET_WEIGHT
             - MARKET_CARRIAGE_COST * RECYCLE_WEIGHT 
             - (CASE WHEN NVL(INPUT_TAX ,0) = 0 
                THEN MARKET_RECYCLE_AMT_BEFTAX  
                ELSE MARKET_RECYCLE_AMT END) * RECYCLE_WEIGHT
             ) END KPI_VALUE1,
       '市场结算重量*综合出成' KPI_VALUE2_NAME,
       MARKET_WEIGHT*PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MARKET_ADDITIONA_PRICE' KPI_CODE,
       '市场附加值' KPI_NAME,
       'MARKET_ADDITIONA_PRICE2' SUB_KPI_CODE,
       '副产品收入' SUB_KPI_NAME,
       '副产品收入+可抵进项税' KPI_VALUE1_NAME,
       CASE WHEN NVL(MARKET_QTY,0)  = 0
        THEN 0 
        ELSE (SECND_INPUT + INPUT_TAX) 
        END  KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'FEE' KPI_CODE,
       '吨费用' KPI_NAME,
       'FEE1' SUB_KPI_CODE,
       '吨费用1' SUB_KPI_NAME,
       'G制造费用固定+G制造费用变动+G水电费+G燃料费+G直接人工费+包装费' KPI_VALUE1_NAME,
       G_WIP_FIX + G_WIP_CHG + G_WATER_ELEC + G_FUEL + G_MANUAL +
       PACKING_FEE KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'FEE' KPI_CODE,
       '吨费用' KPI_NAME,
       'FEE2' SUB_KPI_CODE,
       '吨费用2' SUB_KPI_NAME,
       '管理费用可控+管理费用非可控 +销售费用可控+销售费用非可控+财务费用' KPI_VALUE1_NAME,
       MANAGE_FIXED_FEE + MANAGE_CHG_FEE + SALES_FIXED_FEE + SALES_CHG_FEE +
       FINANCIAL_FEE KPI_VALUE1,
       'CW销量' KPI_VALUE2_NAME,
       SALE_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MARGIN_CONTB' KPI_CODE,
       '边际贡献' KPI_NAME,
       'MARGIN_CONTB1' SUB_KPI_CODE,
       '边际贡献1（同附加值1）' SUB_KPI_NAME,
       '产量*当前售价/税率-结算金额-运费' KPI_VALUE1_NAME,
       SALES_AMT - CARRIAGE_COST - CASE
         WHEN coalesce(INPUT_TAX, 0) = 0 THEN
          RECYCLE_AMT_BEFTAX
         ELSE
          RECYCLE_AMT
       END KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MARGIN_CONTB' KPI_CODE,
       '边际贡献' KPI_NAME,
       'MARGIN_CONTB2' SUB_KPI_CODE,
       '边际贡献2' SUB_KPI_NAME,
       '副产品收入+可抵进项税-(G制造费用变动+G水电费+G燃料费+G直接人工费+包装费)' KPI_VALUE1_NAME,
       SECND_INPUT + INPUT_TAX -
       (G_WIP_CHG + G_WATER_ELEC + G_FUEL + G_MANUAL + PACKING_FEE) KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'MARGIN_CONTB' KPI_CODE,
       '边际贡献' KPI_NAME,
       'MARGIN_CONTB3' SUB_KPI_CODE,
       '边际贡献3' SUB_KPI_NAME,
       '(-1)*管理费用可控 +销售费用可控' KPI_VALUE1_NAME,
       (-1) * (MANAGE_FIXED_FEE + SALES_FIXED_FEE) KPI_VALUE1,
       'CW销量' KPI_VALUE2_NAME,
       SALE_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROFIT' KPI_CODE,
       '吨利润' KPI_NAME,
       'PROFIT1' SUB_KPI_CODE,
       '吨利润1（同边际贡献1）' SUB_KPI_NAME,
       '产量*当前售价/税率-结算金额-运费' KPI_VALUE1_NAME,
       SALES_AMT - CARRIAGE_COST - CASE
         WHEN coalesce(INPUT_TAX, 0) = 0 THEN
          RECYCLE_AMT_BEFTAX
         ELSE
          RECYCLE_AMT
       END KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROFIT' KPI_CODE,
       '吨利润' KPI_NAME,
       'PROFIT2' SUB_KPI_CODE,
       '吨利润2' SUB_KPI_NAME,
       '副产品收入+可抵进项税-(G制造费用变动+G水电费+G燃料费+G直接人工费+包装费)-G制造费用固定' KPI_VALUE1_NAME,
       SECND_INPUT + INPUT_TAX -
       (G_WIP_CHG + G_WATER_ELEC + G_FUEL + G_MANUAL + PACKING_FEE) -
       G_WIP_FIX KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROFIT' KPI_CODE,
       '吨利润' KPI_NAME,
       'PROFIT4' SUB_KPI_CODE,
       '吨利润3' SUB_KPI_NAME,
       '(-1)*(管理费用可控 +销售费用可控)-(管理费用非可控 +销售费用非可控+财务费用)' KPI_VALUE1_NAME,
       (-1) * (MANAGE_FIXED_FEE + SALES_FIXED_FEE) -
       (MANAGE_CHG_FEE + SALES_CHG_FEE + FINANCIAL_FEE) KPI_VALUE1,
       'CW销量' KPI_VALUE2_NAME,
       SALE_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROD_PROFIT' KPI_CODE,
       '生产利润' KPI_NAME,
       'PROD_PROFIT1' SUB_KPI_CODE,
       '吨利润1*产量' SUB_KPI_NAME,
       '(产量*当前售价/税率-结算金额-运费)*产量' KPI_VALUE1_NAME,
       (SALES_AMT - CARRIAGE_COST - CASE
         WHEN coalesce(INPUT_TAX, 0) = 0 THEN
          RECYCLE_AMT_BEFTAX
         ELSE
          RECYCLE_AMT
       END) * PROD_QTY KPI_VALUE1,
       '产量' KPI_VALUE2_NAME,
       PROD_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROD_PROFIT' KPI_CODE,
       '生产利润' KPI_NAME,
       'PROD_PROFIT2' SUB_KPI_CODE,
       '吨利润2*产量' SUB_KPI_NAME,
       '(副产品收入+可抵进项税-(G制造费用变动+G水电费+G燃料费+G直接人工费+包装费)-G制造费用固定)*产量' KPI_VALUE1_NAME,
       (SECND_INPUT + INPUT_TAX -
       (G_WIP_CHG + G_WATER_ELEC + G_FUEL + G_MANUAL + PACKING_FEE) -
       G_WIP_FIX) * PROD_QTY KPI_VALUE1,
       'CW产量' KPI_VALUE2_NAME,
       WIP_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PROD_PROFIT' KPI_CODE,
       '生产利润' KPI_NAME,
       'PROD_PROFIT3' SUB_KPI_CODE,
       '吨利润3*产量' SUB_KPI_NAME,
       '((管理费用可控 +销售费用可控)*(-1)-(管理费用非可控 +销售费用非可控+财务费用))*产量' KPI_VALUE1_NAME,
       ((MANAGE_FIXED_FEE + SALES_FIXED_FEE) * (-1) -
       (MANAGE_CHG_FEE + SALES_CHG_FEE + FINANCIAL_FEE)) * PROD_QTY KPI_VALUE1,
       'CW销量' KPI_VALUE2_NAME,
       SALE_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PER_PROFIT' KPI_CODE,
       '只利润' KPI_NAME,
       'PER_PROFIT1' SUB_KPI_CODE,
       '吨利润1*产量' SUB_KPI_NAME,
       '(产量*当前售价/税率-结算金额-运费)*产量' KPI_VALUE1_NAME,
       (SALES_AMT - CARRIAGE_COST - CASE
         WHEN coalesce(INPUT_TAX, 0) = 0 THEN
          RECYCLE_AMT_BEFTAX
         ELSE
          RECYCLE_AMT
       END) * PROD_QTY KPI_VALUE1,
       '产量*宰杀只数' KPI_VALUE2_NAME,
       PROD_QTY * KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PER_PROFIT' KPI_CODE,
       '只利润' KPI_NAME,
       'PER_PROFIT2' SUB_KPI_CODE,
       '吨利润2*产量' SUB_KPI_NAME,
       '(副产品收入+可抵进项税-(G制造费用变动+G水电费+G燃料费+G直接人工费+包装费)-G制造费用固定)*产量' KPI_VALUE1_NAME,
       (SECND_INPUT + INPUT_TAX -
       (G_WIP_CHG + G_WATER_ELEC + G_FUEL + G_MANUAL + PACKING_FEE) -
       G_WIP_FIX) * PROD_QTY KPI_VALUE1,
       'CW产量*宰杀只数' KPI_VALUE2_NAME,
       WIP_QTY * KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'PER_PROFIT' KPI_CODE,
       '只利润' KPI_NAME,
       'PER_PROFIT3' SUB_KPI_CODE,
       '吨利润3*产量' SUB_KPI_NAME,
       '((管理费用可控 +销售费用可控)*(-1)-(管理费用非可控 +销售费用非可控+财务费用))*产量' KPI_VALUE1_NAME,
       ((MANAGE_FIXED_FEE + SALES_FIXED_FEE) * (-1) -
       (MANAGE_CHG_FEE + SALES_CHG_FEE + FINANCIAL_FEE)) * PROD_QTY KPI_VALUE1,
       'CW销量*宰杀只数' KPI_VALUE2_NAME,
       SALE_QTY * KILLED_QTY KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'GUARANTEED_PRICE' KPI_CODE,
       '保本价' KPI_NAME,
       'GUARANTEED_PRICE1' SUB_KPI_CODE,
       '保本价1' SUB_KPI_NAME,
       '吨综合售价B*产量' KPI_VALUE1_NAME,
       CASE WHEN NVL(INPUT_TAX,0) = 0 
        THEN T_SALES_AMT * PROD_QTY
        ELSE SALES_AMT * PROD_QTY
        END  KPI_VALUE1,
       '产量*结算重量' KPI_VALUE2_NAME,
       PROD_QTY * RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'GUARANTEED_PRICE' KPI_CODE,
       '保本价' KPI_NAME,
       'GUARANTEED_PRICE2' SUB_KPI_CODE,
       '保本价2' SUB_KPI_NAME,
       '(副产品收入-吨费用1+可抵扣进项税)*产量' KPI_VALUE1_NAME,
       CASE WHEN NVL(INPUT_TAX,0) = 0 
        THEN (T_SECND_INPUT - (T_G_WIP_FIX + T_G_WIP_CHG + T_G_WATER_ELEC + T_G_FUEL +
             T_G_MANUAL + T_PACKING_FEE)) * PROD_QTY
        ELSE (SECND_INPUT - (G_WIP_FIX + G_WIP_CHG + G_WATER_ELEC + G_FUEL +
             G_MANUAL + PACKING_FEE) + INPUT_TAX) * PROD_QTY
        END  KPI_VALUE1,
       'CW产量*结算重量' KPI_VALUE2_NAME,
       WIP_QTY * RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,
       '1' KPI_TYPE_CODE,
       '生产指标' KPI_TYPE_NAME,
       '2' KPI_CAL,
       '1' CAL_RULE,
       'GUARANTEED_PRICE' KPI_CODE,
       '保本价' KPI_NAME,
       'GUARANTEED_PRICE3' SUB_KPI_CODE,
       '保本价3' SUB_KPI_NAME,
       '(-1)*吨费用2*产量' KPI_VALUE1_NAME,
       CASE WHEN NVL(INPUT_TAX,0) = 0 
        THEN (-1) * (T_MANAGE_FIXED_FEE + T_MANAGE_CHG_FEE + T_SALES_FIXED_FEE +
             T_SALES_CHG_FEE + T_FINANCIAL_FEE) * PROD_QTY
        ELSE (-1) * (MANAGE_FIXED_FEE + MANAGE_CHG_FEE + SALES_FIXED_FEE +
             SALES_CHG_FEE + FINANCIAL_FEE) * PROD_QTY
        END  KPI_VALUE1,
       'CW销量*结算重量' KPI_VALUE2_NAME,
       SALE_QTY * RECYCLE_WEIGHT KPI_VALUE2,
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
 WHERE OP_DAY = '$OP_DAY'
 UNION ALL
 SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,      
       '1'     KPI_TYPE_CODE,      
       '生产指标'  KPI_TYPE_NAME,      
       '2'      KPI_CAL,    
       '1'    CAL_RULE,     
       'NET_COST'     KPI_CODE,    
       '毛鸡毛鸭成本'        KPI_NAME,   
       'NET_COST1'   SUB_KPI_CODE, 
       '毛鸡毛鸭成本1'      SUB_KPI_NAME,       
       '结算金额+运费'      KPI_VALUE1_NAME,    
       CASE WHEN coalesce(INPUT_TAX ,0) = 0 THEN RECYCLE_AMT_BEFTAX + CARRIAGE_COST ELSE RECYCLE_AMT+CARRIAGE_COST END       KPI_VALUE1,  
       '产量'    KPI_VALUE2_NAME,    
       PROD_QTY       KPI_VALUE2,     
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
WHERE OP_DAY = '$OP_DAY'
UNION ALL 
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,      
       '1'     KPI_TYPE_CODE,      
       '生产指标'  KPI_TYPE_NAME,      
       '2'      KPI_CAL,    
       '-1'   CAL_RULE,     
       'NET_COST'     KPI_CODE,    
       '毛鸡毛鸭成本'        KPI_NAME,   
       'NET_COST2'   SUB_KPI_CODE, 
       '毛鸡毛鸭成本2'      SUB_KPI_NAME,       
       '可抵进项税'        KPI_VALUE1_NAME,    
       INPUT_TAX      KPI_VALUE1,  
       'CW产量'  KPI_VALUE2_NAME,    
       WIP_QTY        KPI_VALUE2,     
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
WHERE OP_DAY = '$OP_DAY'
UNION ALL
SELECT MONTH_ID,
       DAY_ID,
       LEVEL1_ORG_ID,
       LEVEL1_ORG_DESCR,
       LEVEL2_ORG_ID,
       LEVEL2_ORG_DESCR,
       LEVEL3_ORG_ID,
       LEVEL3_ORG_DESCR,
       LEVEL4_ORG_ID,
       LEVEL4_ORG_DESCR,
       LEVEL5_ORG_ID,
       LEVEL5_ORG_DESCR,
       LEVEL6_ORG_ID,
       LEVEL6_ORG_DESCR,
       LEVEL7_ORG_ID,
       LEVEL7_ORG_DESCR,
       LEVEL1_BUSINESSTYPE_ID,
       LEVEL1_BUSINESSTYPE_NAME,
       LEVEL2_BUSINESSTYPE_ID,
       LEVEL2_BUSINESSTYPE_NAME,
       LEVEL3_BUSINESSTYPE_ID,
       LEVEL3_BUSINESSTYPE_NAME,
       LEVEL4_BUSINESSTYPE_ID,
       LEVEL4_BUSINESSTYPE_NAME,
       PRODUCTION_LINE_ID,
       PRODUCTION_LINE_DESCR,      
       '2'     KPI_TYPE_CODE,      
       '原料指标'  KPI_TYPE_NAME,      
       '1'      KPI_CAL,    
       '1'    CAL_RULE,     
       'KILLED_QTY'   KPI_CODE,    
       '宰杀只数'   KPI_NAME,   
       'KILLED_QTY'  SUB_KPI_CODE, 
       '宰杀只数'  SUB_KPI_NAME,       
       '宰杀只数'  KPI_VALUE1_NAME,    
       KILLED_QTY     KPI_VALUE1,  
       ''      KPI_VALUE2_NAME,    
       0       KPI_VALUE2,     
       '$CREATE_TIME' CREATE_TIME
  FROM mreport_poultry.DWP_BIRD_KILL_KPI_DD
WHERE OP_DAY = '$OP_DAY'


"

###########################################################################################
## 将数据从大表转换至目标表
## 变量声明
DMP_BIRD_KILL_KPI_DD='DMP_BIRD_KILL_KPI_DD'

CREATE_DMP_BIRD_KILL_KPI_DD="
CREATE TABLE IF NOT EXISTS $DMP_BIRD_KILL_KPI_DD
(
 MONTH_ID                      STRING    --期间(月)
,DAY_ID                        STRING    --期间(日)
,LEVEL1_ORG_ID                 STRING    --组织1级(股份)
,LEVEL1_ORG_DESCR              STRING    --组织1级(股份)
,LEVEL2_ORG_ID                 STRING    --组织2级(片联)
,LEVEL2_ORG_DESCR              STRING    --组织2级(片联)
,LEVEL3_ORG_ID                 STRING    --组织3级(片区)
,LEVEL3_ORG_DESCR              STRING    --组织3级(片区)
,LEVEL4_ORG_ID                 STRING    --组织4级(小片)
,LEVEL4_ORG_DESCR              STRING    --组织4级(小片)
,LEVEL5_ORG_ID                 STRING    --组织5级(公司)
,LEVEL5_ORG_DESCR              STRING    --组织5级(公司)
,LEVEL6_ORG_ID                 STRING    --组织6级(OU)
,LEVEL6_ORG_DESCR              STRING    --组织6级(OU)
,LEVEL7_ORG_ID                 STRING    --组织7级(库存组织)
,LEVEL7_ORG_DESCR              STRING    --组织7级(库存组织)
,LEVEL1_BUSINESSTYPE_ID        STRING    --业态1级
,LEVEL1_BUSINESSTYPE_NAME      STRING    --业态1级
,LEVEL2_BUSINESSTYPE_ID        STRING    --业态2级
,LEVEL2_BUSINESSTYPE_NAME      STRING    --业态2级
,LEVEL3_BUSINESSTYPE_ID        STRING    --业态3级
,LEVEL3_BUSINESSTYPE_NAME      STRING    --业态3级
,LEVEL4_BUSINESSTYPE_ID        STRING    --业态4级
,LEVEL4_BUSINESSTYPE_NAME      STRING    --业态4级
,PRODUCTION_LINE_ID            STRING    --产线id
,PRODUCTION_LINE_DESCR         STRING    --产线
,KPI_TYPE_CODE              STRING   --指标类型编码
,KPI_TYPE_NAME              STRING   --指标类型名称
,KPI_CAL                    STRING   --指标是否需要计算
,CAL_RULE                   STRING   --指标运算符号
,KPI_CODE                   STRING   --指标编码
,KPI_NAME                   STRING   --指标名称
,SUB_KPI_CODE               STRING   --子指标编码
,SUB_KPI_NAME               STRING   --子指标名称
,KPI_VALUE1_NAME            STRING   --指标值1名称
,KPI_VALUE1                 STRING   --指标值1
,KPI_VALUE2_NAME            STRING   --指标值2名称
,KPI_VALUE2                 STRING   --指标值2
,CREATE_TIME                STRING
)
PARTITIONED BY (op_day string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\011'
STORED AS TEXTFILE
"

## 转换数据
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
INSERT_DMP_BIRD_KILL_KPI_DD="
INSERT OVERWRITE TABLE $DMP_BIRD_KILL_KPI_DD PARTITION(op_day='$OP_DAY')
SELECT MONTH_ID                          --期间(月)
,DAY_ID                            --期间(日)
,LEVEL1_ORG_ID                     --组织1级(股份)
,LEVEL1_ORG_DESCR                  --组织1级(股份)
,LEVEL2_ORG_ID                     --组织2级(片联)
,LEVEL2_ORG_DESCR                  --组织2级(片联)
,LEVEL3_ORG_ID                     --组织3级(片区)
,LEVEL3_ORG_DESCR                  --组织3级(片区)
,LEVEL4_ORG_ID                     --组织4级(小片)
,LEVEL4_ORG_DESCR                  --组织4级(小片)
,LEVEL5_ORG_ID                     --组织5级(公司)
,LEVEL5_ORG_DESCR                  --组织5级(公司)
,LEVEL6_ORG_ID                     --组织6级(OU)
,LEVEL6_ORG_DESCR                  --组织6级(OU)
,LEVEL7_ORG_ID                     --组织7级(库存组织)
,LEVEL7_ORG_DESCR                  --组织7级(库存组织)
,LEVEL1_BUSINESSTYPE_ID            --业态1级
,LEVEL1_BUSINESSTYPE_NAME          --业态1级
,LEVEL2_BUSINESSTYPE_ID            --业态2级
,LEVEL2_BUSINESSTYPE_NAME          --业态2级
,LEVEL3_BUSINESSTYPE_ID            --业态3级
,LEVEL3_BUSINESSTYPE_NAME          --业态3级
,LEVEL4_BUSINESSTYPE_ID            --业态4级
,LEVEL4_BUSINESSTYPE_NAME          --业态4级
,PRODUCTION_LINE_ID                --产线id
,PRODUCTION_LINE_DESCR             --产线
,KPI_TYPE_CODE                 --指标类型编码
,KPI_TYPE_NAME                 --指标类型名称
,KPI_CAL                       --指标是否需要计算
,CAL_RULE                      --指标运算符号
,KPI_CODE                      --指标编码
,KPI_NAME                      --指标名称
,SUB_KPI_CODE                  --子指标编码
,SUB_KPI_NAME                  --子指标名称
,KPI_VALUE1_NAME               --指标值1名称
,coalesce(KPI_VALUE1,0)                    --指标值1
,KPI_VALUE2_NAME               --指标值2名称
,coalesce(KPI_VALUE2,0)                    --指标值2
,CREATE_TIME                 
FROM mreport_poultry.TMP_DMP_BIRD_KILL_KPI_DD_0
WHERE OP_DAY = '$OP_DAY'
"
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>执行语句>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
hive -e "
    use mreport_poultry;
    $CREATE_TMP_DMP_BIRD_KILL_KPI_DD_0;
    $INSERT_TMP_DMP_BIRD_KILL_KPI_DD_0_1;
"  -v

hive -e "
    use mreport_poultry;
    $INSERT_TMP_DMP_BIRD_KILL_KPI_DD_0_2;
    $CREATE_DMP_BIRD_KILL_KPI_DD;
    $INSERT_DMP_BIRD_KILL_KPI_DD;

"  -v

#     $CREATE_DMP_BIRD_KILL_KPI_DD;
#     $CREATE_DMP_BIRD_KILL_KPI_DD;